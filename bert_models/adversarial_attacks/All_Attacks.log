Attacking Models with TextFooler
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.5_labelratio_2022-05-04_00-59-36.pt', text_attack_recipe='TextFooler')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 732    |
| Number of failed attacks:     | 51     |
| Number of skipped attacks:    | 89     |
| Original accuracy:            | 89.79% |
| Accuracy under attack:        | 5.85%  |
| Attack success rate:          | 93.49% |
| Average perturbed word %:     | 17.07% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 95.27  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_EmbeddingAugmenter_adversarialtrained_sst2_106494_samples_2022-05-05_18-40-16.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 741    |
| Number of failed attacks:     | 38     |
| Number of skipped attacks:    | 93     |
| Original accuracy:            | 89.33% |
| Accuracy under attack:        | 4.36%  |
| Attack success rate:          | 95.12% |
| Average perturbed word %:     | 18.54% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 98.97  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_SynonymInsertionAugmenter_adversarialtrained_sst2_106868_samples_2022-05-05_19-10-58.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 734    |
| Number of failed attacks:     | 44     |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 5.05%  |
| Attack success rate:          | 94.34% |
| Average perturbed word %:     | 16.88% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 93.11  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_WordNetAugmenter_adversarialtrained_sst2_106748_samples_2022-05-05_20-18-41.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 716    |
| Number of failed attacks:     | 50     |
| Number of skipped attacks:    | 106    |
| Original accuracy:            | 87.84% |
| Accuracy under attack:        | 5.73%  |
| Attack success rate:          | 93.47% |
| Average perturbed word %:     | 17.57% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 96.36  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_finetuned_sst2_67349_samples_2022-05-03_21-30-41.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 745    |
| Number of failed attacks:     | 42     |
| Number of skipped attacks:    | 85     |
| Original accuracy:            | 90.25% |
| Accuracy under attack:        | 4.82%  |
| Attack success rate:          | 94.66% |
| Average perturbed word %:     | 17.1%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 92.09  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_All_adversarialtrained_sst2_118063_samples_2022-05-07_17-01-42.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 723    |
| Number of failed attacks:     | 39     |
| Number of skipped attacks:    | 110    |
| Original accuracy:            | 87.39% |
| Accuracy under attack:        | 4.47%  |
| Attack success rate:          | 94.88% |
| Average perturbed word %:     | 18.8%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 98.52  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_EmbeddingAugmenter_adversarialtrained_sst2_39145_samples_2022-05-07_16-27-25.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 745    |
| Number of failed attacks:     | 33     |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 3.78%  |
| Attack success rate:          | 95.76% |
| Average perturbed word %:     | 18.74% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 96.04  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_SynonymInsertionAugmenter_adversarialtrained_sst2_39519_samples_2022-05-07_16-25-27.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 747    |
| Number of failed attacks:     | 26     |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 2.98%  |
| Attack success rate:          | 96.64% |
| Average perturbed word %:     | 17.6%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 91.54  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_WordNetAugmenter_adversarialtrained_sst2_39399_samples_2022-05-07_00-47-45.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 747    |
| Number of failed attacks:     | 26     |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 2.98%  |
| Attack success rate:          | 96.64% |
| Average perturbed word %:     | 17.68% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 91.61  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='Yes', model_path='../bertmodel_distillation/Gan_distilbert_sst2_2022-05-08_03-47-09.pt', text_attack_recipe='TextFooler')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



I am here
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 763    |
| Number of failed attacks:     | 11     |
| Number of skipped attacks:    | 98     |
| Original accuracy:            | 88.76% |
| Accuracy under attack:        | 1.26%  |
| Attack success rate:          | 98.58% |
| Average perturbed word %:     | 16.22% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 80.55  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with BAE
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.5_labelratio_2022-05-04_00-59-36.pt', text_attack_recipe='BAE')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 466    |
| Number of failed attacks:     | 317    |
| Number of skipped attacks:    | 89     |
| Original accuracy:            | 89.79% |
| Accuracy under attack:        | 36.35% |
| Attack success rate:          | 59.51% |
| Average perturbed word %:     | 12.88% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 61.21  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_EmbeddingAugmenter_adversarialtrained_sst2_106494_samples_2022-05-05_18-40-16.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 457    |
| Number of failed attacks:     | 322    |
| Number of skipped attacks:    | 93     |
| Original accuracy:            | 89.33% |
| Accuracy under attack:        | 36.93% |
| Attack success rate:          | 58.66% |
| Average perturbed word %:     | 12.95% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 60.27  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_SynonymInsertionAugmenter_adversarialtrained_sst2_106868_samples_2022-05-05_19-10-58.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 465    |
| Number of failed attacks:     | 313    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 35.89% |
| Attack success rate:          | 59.77% |
| Average perturbed word %:     | 13.07% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 59.53  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_WordNetAugmenter_adversarialtrained_sst2_106748_samples_2022-05-05_20-18-41.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 449    |
| Number of failed attacks:     | 317    |
| Number of skipped attacks:    | 106    |
| Original accuracy:            | 87.84% |
| Accuracy under attack:        | 36.35% |
| Attack success rate:          | 58.62% |
| Average perturbed word %:     | 12.94% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 62.04  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_finetuned_sst2_67349_samples_2022-05-03_21-30-41.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 461    |
| Number of failed attacks:     | 326    |
| Number of skipped attacks:    | 85     |
| Original accuracy:            | 90.25% |
| Accuracy under attack:        | 37.39% |
| Attack success rate:          | 58.58% |
| Average perturbed word %:     | 13.0%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 62.0   |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_All_adversarialtrained_sst2_118063_samples_2022-05-07_17-01-42.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 439    |
| Number of failed attacks:     | 323    |
| Number of skipped attacks:    | 110    |
| Original accuracy:            | 87.39% |
| Accuracy under attack:        | 37.04% |
| Attack success rate:          | 57.61% |
| Average perturbed word %:     | 13.69% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 60.52  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_EmbeddingAugmenter_adversarialtrained_sst2_39145_samples_2022-05-07_16-27-25.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 463    |
| Number of failed attacks:     | 315    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 36.12% |
| Attack success rate:          | 59.51% |
| Average perturbed word %:     | 13.53% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 60.95  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_SynonymInsertionAugmenter_adversarialtrained_sst2_39519_samples_2022-05-07_16-25-27.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 456    |
| Number of failed attacks:     | 317    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 36.35% |
| Attack success rate:          | 58.99% |
| Average perturbed word %:     | 13.13% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 60.33  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_WordNetAugmenter_adversarialtrained_sst2_39399_samples_2022-05-07_00-47-45.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 439    |
| Number of failed attacks:     | 334    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 38.3%  |
| Attack success rate:          | 56.79% |
| Average perturbed word %:     | 13.8%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 60.25  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='Yes', model_path='../bertmodel_distillation/Gan_distilbert_sst2_2022-05-08_03-47-09.pt', text_attack_recipe='BAE')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



I am here
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 481    |
| Number of failed attacks:     | 293    |
| Number of skipped attacks:    | 98     |
| Original accuracy:            | 88.76% |
| Accuracy under attack:        | 33.6%  |
| Attack success rate:          | 62.14% |
| Average perturbed word %:     | 13.27% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 59.61  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with DeepWordBug
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.5_labelratio_2022-05-04_00-59-36.pt', text_attack_recipe='DeepWordBug')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 639    |
| Number of failed attacks:     | 144    |
| Number of skipped attacks:    | 89     |
| Original accuracy:            | 89.79% |
| Accuracy under attack:        | 16.51% |
| Attack success rate:          | 81.61% |
| Average perturbed word %:     | 19.09% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.57  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_EmbeddingAugmenter_adversarialtrained_sst2_106494_samples_2022-05-05_18-40-16.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 670    |
| Number of failed attacks:     | 109    |
| Number of skipped attacks:    | 93     |
| Original accuracy:            | 89.33% |
| Accuracy under attack:        | 12.5%  |
| Attack success rate:          | 86.01% |
| Average perturbed word %:     | 19.79% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.13  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_SynonymInsertionAugmenter_adversarialtrained_sst2_106868_samples_2022-05-05_19-10-58.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 648    |
| Number of failed attacks:     | 130    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 14.91% |
| Attack success rate:          | 83.29% |
| Average perturbed word %:     | 20.39% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 35.06  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_WordNetAugmenter_adversarialtrained_sst2_106748_samples_2022-05-05_20-18-41.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 645    |
| Number of failed attacks:     | 121    |
| Number of skipped attacks:    | 106    |
| Original accuracy:            | 87.84% |
| Accuracy under attack:        | 13.88% |
| Attack success rate:          | 84.2%  |
| Average perturbed word %:     | 20.52% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.72  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_finetuned_sst2_67349_samples_2022-05-03_21-30-41.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 650    |
| Number of failed attacks:     | 137    |
| Number of skipped attacks:    | 85     |
| Original accuracy:            | 90.25% |
| Accuracy under attack:        | 15.71% |
| Attack success rate:          | 82.59% |
| Average perturbed word %:     | 18.55% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.16  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_All_adversarialtrained_sst2_118063_samples_2022-05-07_17-01-42.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 661    |
| Number of failed attacks:     | 101    |
| Number of skipped attacks:    | 110    |
| Original accuracy:            | 87.39% |
| Accuracy under attack:        | 11.58% |
| Attack success rate:          | 86.75% |
| Average perturbed word %:     | 20.97% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.35  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_EmbeddingAugmenter_adversarialtrained_sst2_39145_samples_2022-05-07_16-27-25.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 674    |
| Number of failed attacks:     | 104    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 11.93% |
| Attack success rate:          | 86.63% |
| Average perturbed word %:     | 20.51% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 33.91  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_SynonymInsertionAugmenter_adversarialtrained_sst2_39519_samples_2022-05-07_16-25-27.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 673    |
| Number of failed attacks:     | 100    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 11.47% |
| Attack success rate:          | 87.06% |
| Average perturbed word %:     | 20.56% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 33.68  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_WordNetAugmenter_adversarialtrained_sst2_39399_samples_2022-05-07_00-47-45.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 669    |
| Number of failed attacks:     | 104    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 11.93% |
| Attack success rate:          | 86.55% |
| Average perturbed word %:     | 21.17% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 34.2   |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='Yes', model_path='../bertmodel_distillation/Gan_distilbert_sst2_2022-05-08_03-47-09.pt', text_attack_recipe='DeepWordBug')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



I am here
Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 689    |
| Number of failed attacks:     | 85     |
| Number of skipped attacks:    | 98     |
| Original accuracy:            | 88.76% |
| Accuracy under attack:        | 9.75%  |
| Attack success rate:          | 89.02% |
| Average perturbed word %:     | 19.55% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 32.0   |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with Pruthi
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.5_labelratio_2022-05-04_00-59-36.pt', text_attack_recipe='Pruthi')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 368    |
| Number of failed attacks:     | 415    |
| Number of skipped attacks:    | 89     |
| Original accuracy:            | 89.79% |
| Accuracy under attack:        | 47.59% |
| Attack success rate:          | 47.0%  |
| Average perturbed word %:     | 8.08%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 325.89 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_EmbeddingAugmenter_adversarialtrained_sst2_106494_samples_2022-05-05_18-40-16.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 345    |
| Number of failed attacks:     | 434    |
| Number of skipped attacks:    | 93     |
| Original accuracy:            | 89.33% |
| Accuracy under attack:        | 49.77% |
| Attack success rate:          | 44.29% |
| Average perturbed word %:     | 8.57%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 324.42 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_SynonymInsertionAugmenter_adversarialtrained_sst2_106868_samples_2022-05-05_19-10-58.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 305    |
| Number of failed attacks:     | 473    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 54.24% |
| Attack success rate:          | 39.2%  |
| Average perturbed word %:     | 8.33%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 323.43 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_WordNetAugmenter_adversarialtrained_sst2_106748_samples_2022-05-05_20-18-41.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 279    |
| Number of failed attacks:     | 487    |
| Number of skipped attacks:    | 106    |
| Original accuracy:            | 87.84% |
| Accuracy under attack:        | 55.85% |
| Attack success rate:          | 36.42% |
| Average perturbed word %:     | 8.39%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 324.22 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_finetuned_sst2_67349_samples_2022-05-03_21-30-41.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 341    |
| Number of failed attacks:     | 446    |
| Number of skipped attacks:    | 85     |
| Original accuracy:            | 90.25% |
| Accuracy under attack:        | 51.15% |
| Attack success rate:          | 43.33% |
| Average perturbed word %:     | 8.34%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 323.8  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_All_adversarialtrained_sst2_118063_samples_2022-05-07_17-01-42.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 284    |
| Number of failed attacks:     | 478    |
| Number of skipped attacks:    | 110    |
| Original accuracy:            | 87.39% |
| Accuracy under attack:        | 54.82% |
| Attack success rate:          | 37.27% |
| Average perturbed word %:     | 8.33%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 323.97 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_EmbeddingAugmenter_adversarialtrained_sst2_39145_samples_2022-05-07_16-27-25.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 316    |
| Number of failed attacks:     | 462    |
| Number of skipped attacks:    | 94     |
| Original accuracy:            | 89.22% |
| Accuracy under attack:        | 52.98% |
| Attack success rate:          | 40.62% |
| Average perturbed word %:     | 8.75%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 322.41 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_SynonymInsertionAugmenter_adversarialtrained_sst2_39519_samples_2022-05-07_16-25-27.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 281    |
| Number of failed attacks:     | 492    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 56.42% |
| Attack success rate:          | 36.35% |
| Average perturbed word %:     | 8.41%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 325.22 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='No', model_path='../distilbert/finetuned_models/distill_bert_fromsavedmodel_WordNetAugmenter_adversarialtrained_sst2_39399_samples_2022-05-07_00-47-45.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 270    |
| Number of failed attacks:     | 503    |
| Number of skipped attacks:    | 99     |
| Original accuracy:            | 88.65% |
| Accuracy under attack:        | 57.68% |
| Attack success rate:          | 34.93% |
| Average perturbed word %:     | 8.39%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 323.37 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='distilbert', isgan_distil='Yes', model_path='../bertmodel_distillation/Gan_distilbert_sst2_2022-05-08_03-47-09.pt', text_attack_recipe='Pruthi')
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



I am here
Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 341    |
| Number of failed attacks:     | 433    |
| Number of skipped attacks:    | 98     |
| Original accuracy:            | 88.76% |
| Accuracy under attack:        | 49.66% |
| Attack success rate:          | 44.06% |
| Average perturbed word %:     | 8.5%   |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 322.64 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$






Attacking Models with TextFooler
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.2_labelratio_2022-05-08_08-34-28.pt', text_attack_recipe='TextFooler')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 713    |
| Number of failed attacks:     | 23     |
| Number of skipped attacks:    | 136    |
| Original accuracy:            | 84.4%  |
| Accuracy under attack:        | 2.64%  |
| Attack success rate:          | 96.88% |
| Average perturbed word %:     | 15.08% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 80.44  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.7_labelratio_2022-05-08_15-18-12.pt', text_attack_recipe='TextFooler')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapEmbedding(
    (max_candidates):  50
    (embedding):  WordEmbedding
  )
  (constraints): 
    (0): WordEmbeddingDistance(
        (embedding):  WordEmbedding
        (min_cos_sim):  0.5
        (cased):  False
        (include_unknown_words):  True
        (compare_against_original):  True
      )
    (1): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (2): UniversalSentenceEncoder(
        (metric):  angular
        (threshold):  0.840845057
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  False
      )
    (3): RepeatModification
    (4): StopwordModification
    (5): InputColumnModification(
        (matching_column_labels):  ['premise', 'hypothesis']
        (columns_to_ignore):  {'premise'}
      )
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 763    |
| Number of failed attacks:     | 26     |
| Number of skipped attacks:    | 83     |
| Original accuracy:            | 90.48% |
| Accuracy under attack:        | 2.98%  |
| Attack success rate:          | 96.7%  |
| Average perturbed word %:     | 16.3%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 85.96  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with BAE
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.2_labelratio_2022-05-08_08-34-28.pt', text_attack_recipe='BAE')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 476    |
| Number of failed attacks:     | 260    |
| Number of skipped attacks:    | 136    |
| Original accuracy:            | 84.4%  |
| Accuracy under attack:        | 29.82% |
| Attack success rate:          | 64.67% |
| Average perturbed word %:     | 12.61% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 56.53  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.7_labelratio_2022-05-08_15-18-12.pt', text_attack_recipe='BAE')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  delete
  )
  (goal_function):  UntargetedClassification
  (transformation):  WordSwapMaskedLM(
    (method):  bae
    (masked_lm_name):  BertForMaskedLM
    (max_length):  512
    (max_candidates):  50
    (min_confidence):  0.0
  )
  (constraints): 
    (0): PartOfSpeech(
        (tagger_type):  nltk
        (tagset):  universal
        (allow_verb_noun_swap):  True
        (compare_against_original):  True
      )
    (1): UniversalSentenceEncoder(
        (metric):  cosine
        (threshold):  0.936338023
        (window_size):  15
        (skip_text_shorter_than_window):  True
        (compare_against_original):  True
      )
    (2): RepeatModification
    (3): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 456    |
| Number of failed attacks:     | 333    |
| Number of skipped attacks:    | 83     |
| Original accuracy:            | 90.48% |
| Accuracy under attack:        | 38.19% |
| Attack success rate:          | 57.79% |
| Average perturbed word %:     | 13.09% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 59.66  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with DeepWordBug
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.2_labelratio_2022-05-08_08-34-28.pt', text_attack_recipe='DeepWordBug')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 603    |
| Number of failed attacks:     | 133    |
| Number of skipped attacks:    | 136    |
| Original accuracy:            | 84.4%  |
| Accuracy under attack:        | 15.25% |
| Attack success rate:          | 81.93% |
| Average perturbed word %:     | 17.11% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 33.37  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.7_labelratio_2022-05-08_15-18-12.pt', text_attack_recipe='DeepWordBug')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedyWordSwapWIR(
    (wir_method):  unk
  )
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  True
      )
    (1): WordSwapRandomCharacterSubstitution(
        (random_one):  True
      )
    (2): WordSwapRandomCharacterDeletion(
        (random_one):  True
      )
    (3): WordSwapRandomCharacterInsertion(
        (random_one):  True
      )
    )
  (constraints): 
    (0): LevenshteinEditDistance(
        (max_edit_distance):  30
        (compare_against_original):  True
      )
    (1): RepeatModification
    (2): StopwordModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 682    |
| Number of failed attacks:     | 107    |
| Number of skipped attacks:    | 83     |
| Original accuracy:            | 90.48% |
| Accuracy under attack:        | 12.27% |
| Attack success rate:          | 86.44% |
| Average perturbed word %:     | 19.48% |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 33.18  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





Attacking Models with Pruthi
========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.2_labelratio_2022-05-08_08-34-28.pt', text_attack_recipe='Pruthi')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 347    |
| Number of failed attacks:     | 389    |
| Number of skipped attacks:    | 136    |
| Original accuracy:            | 84.4%  |
| Accuracy under attack:        | 44.61% |
| Attack success rate:          | 47.15% |
| Average perturbed word %:     | 8.18%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 322.04 |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





========================================
Namespace(bert_model_type='gan-bert', isgan_distil='No', model_path='../gan-bert/finetuned_models/gan_bert_finetuned_sst2_67349_samples_0.7_labelratio_2022-05-08_15-18-12.pt', text_attack_recipe='Pruthi')
hidden_sizes[i] and [i+1] is 768 and 768
There are 1 GPU(s) available.
We will use the GPU: Tesla V100-SXM2-16GB



Attack(
  (search_method): GreedySearch
  (goal_function):  UntargetedClassification
  (transformation):  CompositeTransformation(
    (0): WordSwapNeighboringCharacterSwap(
        (random_one):  False
      )
    (1): WordSwapRandomCharacterDeletion(
        (random_one):  False
      )
    (2): WordSwapRandomCharacterInsertion(
        (random_one):  False
      )
    (3): WordSwapQWERTY
    )
  (constraints): 
    (0): MaxWordsPerturbed(
        (max_num_words):  1
        (compare_against_original):  True
      )
    (1): MinWordLength
    (2): StopwordModification
    (3): RepeatModification
  (is_black_box):  True
) 


+-------------------------------+--------+
| Attack Results                |        |
+-------------------------------+--------+
| Number of successful attacks: | 347    |
| Number of failed attacks:     | 442    |
| Number of skipped attacks:    | 83     |
| Original accuracy:            | 90.48% |
| Accuracy under attack:        | 50.69% |
| Attack success rate:          | 43.98% |
| Average perturbed word %:     | 8.62%  |
| Average num. words per input: | 17.4   |
| Avg num queries:              | 323.5  |
+-------------------------------+--------+
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$





